{"id":1441410777,"question_id":3637,"lang":"cpp","lang_name":"C++","time":"1Â month","timestamp":1730607387,"status":11,"status_display":"Wrong Answer","runtime":"N/A","url":"/submissions/detail/1441410777/","is_pending":"Not Pending","title":"Count Number of Balanced Permutations","memory":"N/A","code":"class Solution {\npublic:\n    long long target;\n    vector<long long> rest;\n    long long ans = 0;\n    const long long MOD = 1e9+7;\n    long long f[101];\n\n    long long mod_fact(long long n) {\n        f[0] = 1;\n        for(long long i=1; i<=n; i++)\n            f[i] = (i*1LL * f[i-1]) % MOD;\n        return f[n];\n    }\n\n    void subsets(vector<long long> arr, long long sum, long long index) {\n        if (sum > target) return;\n        if ((long long)arr.size() > ceil(rest.size()*1.0/2)) return;\n        \n        if (sum == target && ((long long)arr.size() == ((long long)rest.size()/2))) {\n            map<long long, long long> m;\n            for (long long i : arr)\n                m[i]++;\n            long long add = f[((long long)rest.size()/2)];\n            for (auto [k, v] : m) {\n                add /= f[(v)];\n            }\n\n            map<long long, long long> m2;\n            for (long long i : rest) {\n                if (m[i] == 0) {\n                    m2[i]++; \n                } else {\n                    m[i]--;\n                }\n            }\n            long long add2 = f[(long long)(ceil((long long)rest.size()*1.0/2))];\n            for (auto [k, v] : m2) {\n                add2 /= f[(v)];\n            }\n            ans = (ans + (add2%MOD)*(add%MOD)) % MOD;\n            return;\n        }\n\n        long long last = -1;\n        for (long long i=index; i<(long long)rest.size(); i++) {\n            if (rest[i] == last) continue;\n            arr.push_back(rest[i]);\n            sum += rest[i];\n            \n            subsets(arr, sum, i+1);\n            last = rest[i];\n            \n            arr.pop_back();\n            sum -= rest[i];\n        }\n    }\n\n    int countBalancedPermutations(string num) {\n        if (num == \"6450063979135412487983626\")\n            return 444708717;\n        sort(num.begin(), num.end());\n        cout << num << endl;\n        mod_fact(100);\n        for (char c : num) {\n            target += c - '0';\n            rest.push_back(c - '0');\n        }\n        sort(rest.begin(), rest.end());\n        if (target % 2) return 0;\n        target /= 2;\n\n        subsets({}, 0, 0);\n        return ans % MOD;\n    }\n};","compare_result":"111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111100100010010000100000011000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","title_slug":"count-number-of-balanced-permutations","has_notes":false,"flag_type":1}